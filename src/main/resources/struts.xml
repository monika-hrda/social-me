<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
    "http://struts.apache.org/dtds/struts-2.3.dtd">
    
<struts>
	<constant name="struts.devMode" value="true"></constant>
	<constant name="struts.enable.DynamicMethodInvocation" value="false" />
	 
	 <!-- constant to define result path locations to project root directory -->
	<constant name="struts.convention.result.path" value="/"></constant>
	<!-- constant to define global properties file for i18n (global) messages -->
	<constant name="struts.custom.i18n.resources" value="global"/>
	
	<package name="user" namespace="/" extends="struts-default">	
		<interceptors>
			<interceptor name="authentication" class="mhrda.socialme.interceptors.AuthenticationInterceptor"></interceptor>
			<interceptor-stack name="authStack">
				<interceptor-ref name="authentication"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>
		
		<default-interceptor-ref name="authStack"></default-interceptor-ref>
		
		<global-results>
			<result name="login" type="redirect">/showLogin.action</result>
		</global-results>
		
	    <action name="showLogin">
	    	<interceptor-ref name="defaultStack"></interceptor-ref>
	        <result>/pages/login.jsp</result>
	    </action>
	        
	    <action name="login" class="mhrda.socialme.actions.LoginAction">
	    	<interceptor-ref name="defaultStack"></interceptor-ref>
		    <result name="success" type="redirect">/showProfile.action</result>
		    <result name="error">/pages/login.jsp</result>
		    <result name="input">/pages/login.jsp</result>
	    </action>
	    
	    <action name="logout" class="mhrda.socialme.actions.LoginAction" method="logout">
	    	<interceptor-ref name="defaultStack"></interceptor-ref>
	    	<result name="success" type="redirect">/showLogin.action</result>
	    	<result name="input" type="redirect">/showLogin.action</result>
	    </action>
	    
	    <action name="signup">
	    	<interceptor-ref name="defaultStack"></interceptor-ref>
	        <result>/pages/register.jsp</result>
	    </action>
	    
	    <action name="register" class="mhrda.socialme.actions.RegisterAction">
	    	<interceptor-ref name="defaultStack"></interceptor-ref>
		    <result name="success">/pages/register-success.jsp</result>
		    <result name="error">/pages/register-error.jsp</result>   <!-- zmen -->
		    <result name="input">/pages/register.jsp</result>
	    </action>
	    
	    <action name="showSearch">
		    <result>/pages/search.jsp</result>
	    </action>
	    
	    <action name="search" class="mhrda.socialme.actions.SearchAction">
		    <result name="success">/pages/search-results.jsp</result>
		    <result name="input">/pages/search.jsp</result>
	    </action>
	    
	    <action name="showOwnProfile" class="mhrda.socialme.actions.ShowProfileAction" method="clearSessionProfile">
		    <result name="success" type="redirect">/showProfile.action</result>
	    </action>
	    
	    <action name="showProfile" class="mhrda.socialme.actions.ShowProfileAction">
		    <result name="success" type="redirect">/showProfilePosts.action</result>
		    <result name="error" type="redirect">/showSimpleProfile.action</result>
	    </action>
	    
	    <action name="showSimpleProfile" class="mhrda.socialme.actions.ShowProfileAction" method="showSimpleProfile">
		    <result name="success">/pages/show-simple-profile.jsp</result>
	    </action>
	    
	    <action name="showProfilePosts" class="mhrda.socialme.actions.ShowProfileAction" method="showProfilePosts">
	    	<interceptor-ref name="store">
        		<param name="operationMode">RETRIEVE</param>
    		</interceptor-ref>
    		<interceptor-ref name="authStack" />
	    	<result name="success">/pages/show-profile-posts.jsp</result>
	    	<result name="input">/pages/error-create-post.jsp</result>
	    </action>
	    
	    <action name="createPost" class="mhrda.socialme.actions.PostAction" method="createPost">
	    	<interceptor-ref name="store">
        		<param name="operationMode">STORE</param>
    		</interceptor-ref>
	    	<interceptor-ref name="authStack">
	    		<param name="fileUpload.maximumSize">2097152</param>
	    		<param name="fileUpload.allowedTypes">image/png,image/gif,image/jpeg,image/pjpeg</param>
	    	</interceptor-ref>
	    	<result name="success" type="redirect">/showProfile.action</result>
	    	<result name="input" type="redirect">/showProfile.action</result>
	    </action>
	    
	    <action name="showProfileAbout" class="mhrda.socialme.actions.ShowProfileAction" method="showProfileAbout">
	    	<interceptor-ref name="store">
        		<param name="operationMode">RETRIEVE</param>
    		</interceptor-ref>
    		<interceptor-ref name="authStack" />
		    <result name="success">/pages/show-profile-about.jsp</result>
	    </action>
	    
	    <action name="showEditProfile" class="mhrda.socialme.actions.ShowProfileAction" method="showEditProfile">
	    	<interceptor-ref name="store">
        		<param name="operationMode">RETRIEVE</param>
    		</interceptor-ref>
    		<interceptor-ref name="authStack" />
		    <result name="success">/pages/show-profile-edit.jsp</result>
		    <result name="input">/pages/show-profile-edit.jsp</result>
	    </action>
	    
	    <action name="saveProfile" class="mhrda.socialme.actions.EditProfileAction" method="saveProfile">
	    	<interceptor-ref name="store">
        		<param name="operationMode">STORE</param>
    		</interceptor-ref>
	    	<interceptor-ref name="authStack">
	    		<param name="fileUpload.maximumSize">2097152</param>
	    		<param name="fileUpload.allowedTypes">image/png,image/gif,image/jpeg,image/pjpeg</param>
	    	</interceptor-ref>
		    <result name="success" type="redirect">/showProfileAbout.action</result>
		    <result name="input" type="redirect">/showEditProfile.action</result>
	    </action>
	    
	    <action name="showProfileFriends" class="mhrda.socialme.actions.ShowProfileAction" method="showProfileFriends">
	    	<result name="success">/pages/show-friends.jsp</result>
	    </action>
	    
	    <action name="showFriendRequests" class="mhrda.socialme.actions.ShowProfileAction" method="showFriendRequests">
	    	<result name="success">/pages/show-friend-requests.jsp</result>
	    </action>
	    
	    <action name="requestFriend" class="mhrda.socialme.actions.FriendsAction" method="requestFriend">
	    	<result name="success" type="redirect">/showProfile.action</result> <!-- to be changed -->
	    	<result name="error">/pages/register-error.jsp</result> <!-- zmen, create interceptor for exceptions -->
	    </action>
	    
	    <action name="acceptFriend" class="mhrda.socialme.actions.FriendsAction" method="acceptFriend">
	    	<result name="success" type="redirect">/showFriendRequests.action</result> <!-- to be changed -->
	    </action>
	    
	    <action name="rejectFriend" class="mhrda.socialme.actions.FriendsAction" method="rejectFriend">
	    	<result name="success" type="redirect">/showFriendRequests.action</result> <!-- to be changed -->
	    </action>
	    
	    <action name="createComment" class="mhrda.socialme.actions.CommentAction" method="createComment">
	    	<result name="success" type="redirect">/showProfile.action</result>
	    </action>
	    
	</package>
	
</struts>